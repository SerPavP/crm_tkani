# Общее понимание проекта: CRM для тканевого бизнеса

## 1. Цель проекта
Проект "CRM Ткани" представляет собой систему управления взаимоотношениями с клиентами и внутренними процессами для бизнеса, занимающегося продажей тканей. Основная цель - автоматизация учета тканей, рулонов на складе, сделок с клиентами, а также предоставление инструментов для финансовой аналитики и управления.

## 2. Ключевые модули и их назначение

### 2.1. Главная страница (`/core/`)
- **Назначение**: Центральный дашборд, предоставляющий быстрый доступ к основным операциям и краткой статистике.
- **Основные функции**:
    - "Быстрые действия": создание сделок, добавление клиентов, тканей, рулонов.
    - "Быстрая статистика": обзор выручки за различные периоды.
    - Список последних сделок и клиентов.

### 2.2. Сделки (`/deals/`)
- **Назначение**: Управление продажами и заказами клиентов.
- **Основные функции**:
    - Создание новых сделок.
    - Добавление позиций в сделку (ткань, цвет, ширина, цена).
    - Динамический расчет общей суммы сделки, суммы с НДС и прибыли.
    - Отслеживание статусов сделок (создан, ожидание оплаты, оплачен).

### 2.3. Ткани (`/fabrics/`)
- **Назначение**: Учет ассортимента тканей и их цветов.
- **Основные функции**:
    - Каталог тканей с фильтрацией и поиском.
    - Добавление и редактирование информации о тканях и их цветах.
    - Отображение общего количества метров на складе для каждой ткани и цвета.
    - Управление себестоимостью и ценой продажи.

### 2.4. Клиенты (`/clients/`)
- **Назначение**: Управление базой клиентов.
- **Основные функции**:
    - Добавление и редактирование данных клиентов.
    - Просмотр списка клиентов.

### 2.5. Склад (`/warehouse/`)
- **Назначение**: Учет рулонов ткани на складе.
- **Основные функции**:
    - Создание уникальных штрих-кодов для рулонов.
    - Отслеживание наличия рулонов (активные/неактивные).
    - Привязка рулонов к определенным цветам тканей.

### 2.6. Финансы (`/finances/`)
- **Назначение**: Предоставление детальной финансовой аналитики.
- **Основные функции**:
    - **KPI-блоки**: Выручка, прибыль, рентабельность, средний чек, количество сделок, топ-ткань месяца.
    - **Быстрая информация**: Сводка по дням/неделям/месяцам/кварталам, топ-клиенты (по прибыли, количеству сделок, сумме), топ-ткани (по частоте заказов, прибыли, выручке).
    - **По периодам**: Детальный отчет по сделкам за выбранный период с фильтрацией и динамическим обновлением.
    - Настройки НДС и себестоимости тканей.

## 3. Как это работает (основной поток)
1.  **Настройка**: Администратор устанавливает себестоимость тканей и ставку НДС.
2.  **Закупка/Поступление**: Заносятся новые ткани и их цвета. Для каждой новой партии или рулона создается запись на складе со штрих-кодом (в данный момент через форму, в будущем - через сканер).
3.  **Продажа (Сделка)**: При продаже создается сделка, в которую добавляются позиции (ткань, цвет, ширина, цена). Система автоматически рассчитывает общую сумму и прибыль по сделке.
4.  **Списание со склада**: После оплаты сделки (или изменения статуса), проданные метры ткани могут списываться со склада (этот функционал, возможно, потребует доработки в будущем).
5.  **Аналитика**: Директор или бухгалтер может в реальном времени отслеживать финансовые показатели, выручку, прибыль, эффективность продаж по клиентам и тканям через финансовую панель.

## 4. Роли пользователей
- **Администратор**: Полный доступ ко всем функциям, включая финансовую аналитику, настройки системы и управление пользователями.
- **Бухгалтер**: Доступ к финансовой аналитике, сделкам, клиентам, тканям, но без настроек пользователей.
- **Кладовщик**: Ограниченный доступ только к функциям склада (сканирование, создание рулонов, просмотр рулонов) и каталогу тканей.

--- 