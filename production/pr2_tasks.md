# Задачи для Программиста 2 (PR2)

## Введение
Этот документ описывает конкретные задачи, которые необходимо выполнить в рамках проекта CRM для тканевого бизнеса. Каждая задача сопровождается указанием затронутых частей системы (backend/frontend/templates) и комментарием `(pr2)` в коде для удобства поиска.

## 1. Функционал кнопок на странице настроек (`/finances/settings/`)

**Задача**: Реализовать функционал для кнопок на странице настроек.

**Место в коде**:
-   `finances/views.py`: Добавить новые view-функции для обработки запросов от этих кнопок.
-   `finances/urls.py`: Добавить соответствующие URL-маршруты для новых view-функций.
-   `templates/finances/system_settings.html`: Реализовать отправку запросов (скорее всего, AJAX) при нажатии на кнопки.

**Детали функционала**:
-   **Экспортировать данные**: 
    -   Выгрузка ключевых данных (сделки, клиенты, ткани, рулоны) в формат CSV или Excel.
    -   Должна быть возможность выбора, какие данные экспортировать.
-   **Импортировать данные**: 
    -   Загрузка данных из CSV или Excel файла в систему.
    -   Необходимо предусмотреть валидацию данных и обработку ошибок.
    -   Например, для `Deal`, `Client`, `Fabric`, `FabricColor`, `FabricRoll`.
-   **Очистка данных**: 
    -   Удаление всех данных из определенных моделей (например, тестовых данных).
    -   **Внимание**: Это критическая операция! Требуется подтверждение пользователя и, возможно, ограничение доступа только для суперпользователей.
-   **Резервная копия**: 
    -   Создание дампа всей базы данных (например, `python manage.py dumpdata`).
    -   Возможность сохранения файла резервной копии на сервере или скачивания пользователем.

**Пример пометки в коде (pr2)**:

```python
# finances/views.py
def system_settings(request):
    # ... существующий код ...

# (pr2) Добавить view для экспорта данных
def export_data(request):
    pass

# (pr2) Добавить view для импорта данных
def import_data(request):
    pass

# (pr2) Добавить view для очистки данных
def clear_data(request):
    pass

# (pr2) Добавить view для резервной копии
def backup_data(request):
    pass
```

```html
<!-- templates/finances/system_settings.html -->
<!-- (pr2) Добавить кнопки и JS для экспорта/импорта/очистки/резервной копии -->
<button type="button" class="btn btn-primary" id="export-btn"><!-- ... --></button>
<button type="button" class="btn btn-info" id="import-btn"><!-- ... --></button>
<!-- ... -->
```

## 2. Считывание QR/Штрих-кода через камеру (`/warehouse/scan-barcode/`)

**Задача**: Реализовать считывание QR-кодов или штрих-кодов через камеру ноутбука.

**Место в коде**:
-   `warehouse/views.py`: Возможно, потребуется view для обработки считанных данных.
-   `templates/warehouse/scan_barcode.html` (или создать, если нет): Основная работа будет здесь.

**Детали функционала**:
-   Использование JavaScript-библиотеки (например, `instascan`, `quaggaJS` или `zxing-js`) для доступа к камере и распознавания кодов.
-   Отображение видеопотока с камеры на странице.
-   Автоматическое распознавание кода и отправка его на сервер для поиска рулона.
-   Отображение информации о найденном рулоне или сообщения об ошибке.

**Пример пометки в коде (pr2)**:

```javascript
// templates/warehouse/scan_barcode.html
<script>
// (pr2) Инициализация сканера QR/штрих-кодов
// ...
</script>
```

## 3. Отображение и печать QR/Штрих-кода (`/warehouse/print/<barcode_number>/`)

**Задача**: Реализовать страницу для отображения и печати QR-кода или штрих-кода с сопутствующей информацией.

**Место в коде**:
-   `warehouse/views.py`: View-функция для генерации страницы с данными для печати.
-   `warehouse/urls.py`: URL-маршрут для этой view-функции.
-   `templates/warehouse/print_barcode.html` (создать): Шаблон для печати.
-   Python-библиотеки для генерации QR-кода/штрих-кода (например, `qrcode`, `python-barcode`).

**Детали функционала**:
-   Страница должна принимать номер штрих-кода/QR-кода в URL.
-   На странице должны отображаться:
    -   Название ткани
    -   Название цвета
    -   Ширина рулона
    -   Дата создания рулона
    -   Сам QR-код или штрих-код (графическое изображение)
    -   Цифры штрих-кода (если применимо).
-   **Кнопка печати**: При нажатии должна запускать стандартное диалоговое окно печати браузера, оптимизированное для печати этикеток (CSS для `@media print`).
-   Возможность генерации PDF через сервер (например, с использованием `ReportLab`) для более точного контроля над форматом печати.

**Пример пометки в коде (pr2)**:

```python
# warehouse/views.py
# (pr2) Добавить view для печати штрих-кода
def print_barcode(request, barcode_number):
    # ...
    pass
```

```html
<!-- templates/warehouse/print_barcode.html -->
<!-- (pr2) Разметка для печати QR/штрих-кода -->
```

--- 